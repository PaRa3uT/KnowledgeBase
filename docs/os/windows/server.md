# Windows Server
## Hyper-V

## AppLockker
    Stage 1 = Audit mode
    Stage 2 = Rules mode

    sc query AppIDSvc
    sc config AppIDSvc start=auto (Запускаем службу Application Identity («Удостоверение приложения»),)
    sc start AppIDSvc

    Applocker доступен только в редакция Enterprise и Ultimate. В Pro можно использовать обычный SRP
    В остальных редакциях - просто импортируется ветка реестра ..Policies\Safer с XP Pro и выше, и SRP отлично работает даже в домашней версии Win7/8/8.1.

    Создаём правила по умолчанию
        Computer Configuration -> Windows Settings -> Security Settings -> Application Control Policies -> AppLocker -> Executable Rules (Конфигурация компьютера -> Конфигурация Windows -> Параметры безопасности -> Политики управления приложениями -> AppLocker -> Исполняемые правила
        Computer Configuration -> Windows Settings -> Security Settings -> Application Control Policies -> AppLocker -> Script Rules

    Отключить службу AppLocker можно через реестр:
        HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\services\AppIDSvc
        Установить Start = 0x4

## Замена диска в программном RAID 1
```
Удалить отказавшее зеркало у тома с отказавшей избыточностью, для чего в контекстном меню тома выбрать пункт "Удалить зеркало...", в окне "Удалить зеркало" выбрать в списке отсутствующий (неисправный) диск, нажать "Удалить зеркало" - в результате том станет простым динамическим;
Удалить информацию о неисправном диске, для чего в его контекстном меню нужно выбрать пункт "Изъять диск";
Добавить зеркало к ставшему простым динамическому тому, для чего нужно в его контекстном меню выбрать пункт "Добавить зеркало", в окне "Добавить зеркальный том" выделить новый диск и нажать "Добавить зеркальный том", после чего начнётся процесс ресинхронизации тома.

В начале ресинхронизации тома нельзя перезагружать и выключать компьютер.
```
## Read Only Domain Controller (RODC)
https://winitpro.ru/index.php/2017/11/08/ustanovka-rodc-kontrollera-domena-na-windows-server-2016/
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732301(v=ws.10)?redirectedfrom=MSDN
```
Установка RODC
Ставится как обычный DC, только при установке надо выбрать что только для чтения
```
```
Пользователи которым разрешён вход:
    на контроллер домена, даже только для чтения, вход обычным пользователям по умолчанию запрещён
    должны быть в доменной группе "Группа с разрешением репликации паролей RODC"
    - gpedit.msc: Конфигурация Windows -> Параметры безопасности -> Локальные политики -> Назначение прав пользователя: Локальных вход в систему (Нету Users, возможно из-за этого не могут входить обычные пользователи)
    Локальные политики компьютера мы менять похоже не можем
    Остаётся либо менять доменную политику "Default Domain Controllers Policy" через "Управление групповой политикой", либо рядом создавать новую политику, где переопределить "Локальных вход в систему" и выставить у это политики приоритет выше
    Либо через DSMGMT добавить пользователя в локальные группы, которым разрешён вход: dsmgmt.exe; local roles; List Roles; add <DOMAIN>\<user> <administrative role>
? Кэширование паролей
```
```
Уделение RODC
Диспетчер серверов -> Управление -> Удалить роли и компоненты
```

## Server 2008 (x86 6.0 SP2 6002 (Vista))
Тупиковая точка, дальше не обновиться, обновиться на 2008 R2 можно только с x64

## Server 2008 R2
    Обновление до 2012 R2:
        Требуется 14223 МБ свободного места
        Из ОС запустить установку, и выбрать обновление
        "Диспетчер серверов" вылетает с ошибкой (Заработал после установки всех обязательных обновлений + IE11 + .NET Framework 4.8)

## Server 2012 R2
    Обновление до 2019
        Требует ключ для установки
        Было свободно 18ГБ
        Прошло успешно

## Server 2016

## Server 2019
    Upgrade to 2022:
        0xC1900101 – 0x20017, Installation failed in SAFE_OS phase with an error during BOOT operation
        Ставил на VirtualBox
        Проблема решилась после того как убрал все диски, кроме системного, добавил RAM до 5ГБ и выставил кол-во ЦП = 4

## Server 2022
